import Pool from'./pool';import ComponentInterface from'../../core/component-interface';let doc=window.document,DIV='div';class ComponentPool extends ComponentInterface{configure(a,b){let c,d,e,f,g,h=this,i=a.getFromEnv('animationManager'),j=h.config;if(e=j.elemTypes={KEY_RECT:'rect',KEY_TEXT:'text',KEY_GROUP:'group',KEY_SCROLLER:'scroller',KEY_BUTTON:'button',KEY_PATH:'path',KEY_DIV:'div'},f=j.cachedState={},c=j.actions={},c[e.KEY_DIV]=function(){return doc.createElement(DIV)},c[e.KEY_RECT]=function(a){return i.setAnimation({el:'rect',container:a,component:h})},c[e.KEY_TEXT]=function(a){return i.setAnimation({el:'text',container:a,component:h})},c[e.KEY_GROUP]=function(a,b){return i.setAnimation({el:'group',attr:{name:a},container:b,component:h})},c[e.KEY_SCROLLER]=function(a,b,c,d,e,f,g){return i.setAnimation({el:'scroller',attr:{scroller:[a,b,c,d,e,f,g]},component:h})},c[e.KEY_BUTTON]=function(a,b,c,d,e,f){return i.setAnimation({el:'button',attr:{button:[a,b,c,d,e,f]},component:h})},c[e.KEY_PATH]=function(a,b){i.setAnimation({el:'path',container:b,attr:{path:a},component:h})},g=j.cache=f[b]||(f[b]={}),ComponentPool._hideRecursive(g.pool),!g.initialized){var k=new Pool;d=g.pool=k.pool,d._tmp=b,g.initialized=!0}}static _hideRecursive(a){var b,c,d,e,f,g;if(a)for(b in a)for(c in d=a[b],d)if(e=d[c],e instanceof Array)for(f=0,g=e.length;f<g;f++)e[f].hide&&e[f].hide();else e.hide&&e.hide()}emptyPool(a){var b,c=this.config;b=c.cachedState[a]||{},b.pool&&(b.pool={})}isInitialized(){return this.config.initialized}getCreationStatus(){return this.config.newCreationDataFlag}hideRecursive(a){var b;b=this.config.cachedState[a]||{},ComponentPool._hideRecursive(b.pool)}getKeys(){return this.config.elemTypes}getComponent(a,b,c,d){var e,f,g,h=this.config,i=h.cachedState[b||0]||{},j=i.pool,k=j[a],l=h.actions,m=0;return k||(k=j[a]={}),f=k[c],f&&!(f instanceof Array)&&!f.removed||f instanceof Array&&0<f.length?function(){return i.newCreationDataFlag=!1,d?(g=f[m++],g&&!g.removed?g.show():f[m]=l[c].apply(i,arguments)):f.show&&'function'==typeof f.show&&f.show()||f}:function(){return i.newCreationDataFlag=!0,d?(e=k[c]||(k[c]=[]),f=l[c].apply(i,arguments),e.push(f),f.show&&'function'==typeof f.show&&f.show()||f):k[c]=l[c].apply(i,arguments)}}}export default ComponentPool;